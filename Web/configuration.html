<div id="JMSFusionConfigPage"
     data-role="page"
     class="page type-interior pluginConfigurationPage"
     translate="no" data-jf-no-translate="1">

  <div class="content-primary">
    <div class="verticalSection">
      <h2 data-jf-no-translate="1">JMS-Fusion</h2>
      <p data-jf-no-translate="1">
        Serves files under <code>/slider</code> and injects <code>&lt;script type="module"&gt;</code> tags into <code>index.html</code> (response rewrite).<br>
        If no external directory is configured, embedded assets under <code>/Resources/slider</code> are served.
      </p>
    </div>

    <form id="configForm" onsubmit="return false;">
      <div class="inputContainer">
        <label class="inputLabel" for="scriptDir">Script Directory</label>
        <input id="scriptDir" type="text" class="emby-input" placeholder="/home/gkhng/slider">
        <div class="fieldDescription">Leave empty to use embedded <code>/Resources/slider</code></div>
      </div>

      <div class="inputContainer">
        <label class="inputLabel" for="playerSub">Player Subdirectory</label>
        <input id="playerSub" type="text" class="emby-input" placeholder="modules/player">
      </div>

      <div class="buttonContainer" data-jf-no-translate="1" style="margin-top:16px; display:flex; gap:8px; flex-wrap:wrap;">
        <button id="saveBtn" type="button" class="raised button-submit">Save</button>
        <button id="refreshEnvBtn" type="button" class="raised">Refresh Web Path & Permissions</button>
        <button id="copyAclBtn" type="button" class="raised">Copy Permission Commands</button>
        <button id="patchBtn" type="button" class="raised">Patch (Inject into index.html)</button>
        <button id="unpatchBtn" type="button" class="raised">Unpatch (Remove from index.html)</button>
      </div>
    </form>

    <div id="msg" class="fieldDescription" data-jf-no-translate="1" style="min-height:24px; margin-top:12px;"></div>

    <div class="verticalSection" style="margin-top:20px;">
      <h3 data-jf-no-translate="1">Status</h3>
      <pre id="status" class="preformatted" style="margin-top:12px;" data-jf-no-translate="1">Status hasn’t been loaded yet…</pre>
    </div>

    <div class="verticalSection" style="margin-top:20px;">
      <h3 data-jf-no-translate="1">In-Memory Injection</h3>
      <div id="inmem" class="fieldDescription" style="margin-top:12px;" data-jf-no-translate="1">
        Checking in-memory status…
      </div>
    </div>

    <div class="verticalSection" style="margin-top:20px;">
      <h3 data-jf-no-translate="1">HTML Snippet</h3>
      <div id="snippet" style="margin-top:12px; border:1px solid #ddd; padding:10px;" data-jf-no-translate="1">
        Snippet hasn’t been loaded yet…
      </div>
    </div>

    <div class="verticalSection" style="margin-top:20px;">
      <h3 data-jf-no-translate="1">Web Path & Permissions</h3>
      <div id="envBox" style="margin-top:12px; border:1px solid #ddd; padding:10px;">
        <div><b>Running user:</b> <code id="envUser">?</code></div>
        <div style="margin-top:6px;"><b>Detected web root:</b> <code id="envWebRoot">?</code></div>
        <div style="margin-top:6px;"><b>Files:</b>
          <ul style="margin:6px 0 0 16px;">
            <li><code>index.html</code>: <span id="envIdx">?</span></li>
            <li><code>index.html.gz</code>: <span id="envGz">?</span></li>
            <li><code>index.html.br</code>: <span id="envBr">?</span></li>
          </ul>
        </div>
        <div style="margin-top:10px;"><b>Suggested ACL commands:</b></div>
        <pre id="envAcl" class="preformatted" style="margin-top:6px; white-space:pre-wrap;">(not computed yet)</pre>
      </div>
    </div>
  </div>

  <style>
#JMSFusionConfigPage {
  --jf-primary: #00a4dc;
  --jf-primary-hover: #0088bf;
  --jf-success: #00b893;
  --jf-warning: #ff9a14;
  --jf-error: #e53935;
  --jf-bg-light: #f5f5f5;
  --jf-border-light: #e0e0e0;
  --jf-text-dark: #212121;
  --jf-text-light: #f5f5f5;
  --jf-card-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  --jf-card-radius: 8px;
}

.theme-dark #JMSFusionConfigPage {
  --jf-bg-light: #2b2b2b;
  --jf-border-light: #404040;
  --jf-text-dark: #eaeaea;
  --jf-card-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

#JMSFusionConfigPage .content-primary {
  padding: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

#JMSFusionConfigPage .verticalSection {
  margin-bottom: 24px;
  padding: 16px;
  background-color: var(--cardBackgroundColor);
  border-radius: var(--jf-card-radius);
  box-shadow: var(--jf-card-shadow);
}

#JMSFusionConfigPage h2 {
  color: var(--primaryAccentColor);
  margin-bottom: 16px;
  font-size: 24px;
  font-weight: 600;
}

#JMSFusionConfigPage h3 {
  color: var(--textColor);
  margin-bottom: 12px;
  font-size: 18px;
  font-weight: 600;
}

#JMSFusionConfigPage p {
  color: var(--textColor);
  line-height: 1.5;
  margin-bottom: 16px;
}

#JMSFusionConfigPage .inputContainer {
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--cardBackgroundColor);
  border-radius: var(--jf-card-radius);
  box-shadow: var(--jf-card-shadow);
}

#JMSFusionConfigPage .inputLabel {
  display: block;
  margin-bottom: 8px;
  color: var(--textColor);
  font-weight: 500;
}

#JMSFusionConfigPage .emby-input {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--jf-border-light);
  border-radius: 4px;
  background-color: var(--inputBackgroundColor);
  color: var(--textColor);
  font-size: 14px;
  transition: border-color 0.2s ease;
}

#JMSFusionConfigPage .emby-input:focus {
  border-color: var(--jf-primary);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 164, 220, 0.2);
}

#JMSFusionConfigPage .fieldDescription {
  margin-top: 8px;
  font-size: 13px;
  color: var(--labelTextColor);
  line-height: 1.4;
}

#JMSFusionConfigPage .fieldDescription.ok {
  color: var(--jf-success);
}

#JMSFusionConfigPage .fieldDescription.warn {
  color: var(--jf-warning);
}

#JMSFusionConfigPage .fieldDescription.err {
  color: var(--jf-error);
}

#JMSFusionConfigPage .buttonContainer {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin: 20px 0;
}

#JMSFusionConfigPage .raised {
  padding: 10px 16px;
  border: none;
  border-radius: 4px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  background-color: var(--buttonBackgroundColor);
  color: var(--buttonTextColor);
}

#JMSFusionConfigPage .raised:hover {
  background-color: var(--buttonHoverBackgroundColor);
  transform: translateY(-1px);
}

#JMSFusionConfigPage .button-submit {
  background-color: var(--jf-primary);
  color: white;
}

#JMSFusionConfigPage .button-submit:hover {
  background-color: var(--jf-primary-hover);
}

#JMSFusionConfigPage #msg {
  padding: 12px 16px;
  border-radius: 4px;
  margin: 16px 0;
  background-color: var(--cardBackgroundColor);
  border-left: 4px solid transparent;
}

#JMSFusionConfigPage #msg.ok {
  border-left-color: var(--jf-success);
  background-color: rgba(0, 184, 147, 0.1);
}

#JMSFusionConfigPage #msg.warn {
  border-left-color: var(--jf-warning);
  background-color: rgba(255, 154, 20, 0.1);
}

#JMSFusionConfigPage #msg.err {
  border-left-color: var(--jf-error);
  background-color: rgba(229, 57, 53, 0.1);
}

#JMSFusionConfigPage pre.preformatted {
  padding: 16px;
  background-color: var(--inputBackgroundColor);
  border-radius: 4px;
  border: 1px solid var(--jf-border-light);
  overflow: auto;
  font-family: 'Consolas', 'Monaco', monospace;
  font-size: 13px;
  line-height: 1.4;
  color: var(--textColor);
}

#JMSFusionConfigPage #snippet,
#JMSFusionConfigPage #envBox {
  padding: 16px;
  background-color: var(--inputBackgroundColor);
  border-radius: 4px;
  border: 1px solid var(--jf-border-light);
  font-size: 14px;
  line-height: 1.5;
  color: var(--textColor);
}

#JMSFusionConfigPage #snippet code,
#JMSFusionConfigPage #envBox code {
  background-color: rgba(0, 0, 0, 0.05);
  padding: 2px 4px;
  border-radius: 3px;
  font-family: 'Consolas', 'Monaco', monospace;
}

.theme-dark #JMSFusionConfigPage #snippet code,
.theme-dark #JMSFusionConfigPage #envBox code {
  background-color: rgba(255, 255, 255, 0.1);
}

#JMSFusionConfigPage .ok {
  color: var(--jf-success);
  font-weight: 500;
}

#JMSFusionConfigPage .warn {
  color: var(--jf-warning);
  font-weight: 500;
}

#JMSFusionConfigPage ul {
  margin: 8px 0;
  padding-left: 24px;
}

#JMSFusionConfigPage li {
  margin-bottom: 4px;
  color: var(--textColor);
}

@media (max-width: 768px) {
  #JMSFusionConfigPage .buttonContainer {
    flex-direction: column;
  }

  #JMSFusionConfigPage .raised {
    width: 100%;
  }

  #JMSFusionConfigPage .content-primary {
    padding: 12px;
  }
}
</style>
  <script src="/Plugins/JMSFusion/assets/UiJs" type="text/javascript" data-jf-no-translate="1"></script>
</div>
